{"version":3,"sources":["Scheduler.js"],"names":[],"mappings":"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","file":"Scheduler-compiled.js","sourcesContent":["/**\n * @author Dominik MÃ¼ller (Ashura) ashura@aimei.ch\n */\n\n\"use strict\";\n\n/**\n *\n * @type {{types: {jobs: string, classes: string, schedules: string}, init: Scheduler.init, restore: Scheduler.restore, load: Scheduler.load, addEventListeners: Scheduler.addEventListeners}}\n */\nvar Scheduler = {\n    /**\n     * What types the Scheduler loads.\n     */\n    types:             {\n        \"jobs\":      \"Berufe\",\n        \"classes\":   \"Klassen\",\n        \"schedules\": \"Stundenplan\"\n    },\n    /**\n     * Initialize function for the Scheduler\n     */\n    init:              function() {\n        var $klasse = $('#klasse');\n        var $beruf  = $('#beruf');\n        var berufe  = localStorage.getItem('berufe');\n        // If the jobs where loaded, get them from cache.\n        if (berufe !== null && typeof berufe !== 'undefined') {\n            berufe = JSON.parse(berufe);\n            for (let beruf in berufe) {\n                //noinspection JSUnfilteredForInLoop,JSUnresolvedVariable\n                $beruf.append('<option value=\"' + berufe[beruf].beruf_id + '\">' + berufe[beruf].beruf_name + '</option>');\n            }\n            $beruf.removeAttr('disabled');\n\n            var klassen = localStorage.getItem('klassen');\n            // If the classes where loaded aswell, get them from cache.\n            if (klassen !== null && typeof klassen !== 'undefined') {\n                klassen = JSON.parse(klassen);\n                for (let klasse in klassen) {\n                    //noinspection JSUnfilteredForInLoop,JSUnresolvedVariable\n                    $klasse.append('<option value=\"' + klassen[klasse].klasse_id + '\" title=\"' + klassen[klasse].klasse_longname + '\">' + klassen[klasse].klasse_name + '</option>');\n                }\n            }\n        } else {\n            // Load the jobs\n            this.load(this.types.jobs);\n        }\n        this.addEventListeners();\n        this.restore();\n        App.boot();\n    },\n    /**\n     * Restore selected job and class.\n     */\n    restore:           function() {\n        var selectedJob = localStorage.getItem('beruf');\n        if (selectedJob !== null) {\n            var $beruf  = $('#beruf');\n            var $klasse = $('#klasse');\n            $beruf.val(selectedJob);\n            $klasse.parent().parent().show();\n\n            var selectedClass = localStorage.getItem('klasse');\n            if (selectedClass !== null) {\n                $klasse.val(selectedClass);\n                $klasse.removeAttr('disabled');\n                $('.scheduler-body').hide();\n                $('.filters.panel-heading').addClass('closed');\n                $('#calendar-container').addClass('boot-start');\n            } else {\n                $beruf.trigger('change');\n            }\n        }\n    },\n    /**\n     * This function loads the data from the GIBM Server.\n     *\n     * @param type string\n     * @param data string\n     * @param callback function\n     */\n    load:              function(type, data, callback) {\n        switch (type) {\n            case this.types.jobs:\n                // Load and add jobs to the DOM\n                $.ajax(\n                    {\n                        \"url\":     \"http://home.gibm.ch/interfaces/133/berufe.php\",\n                        \"async\":   true,\n                        \"success\": function(data) {\n                            var $beruf = $('#beruf');\n                            localStorage.setItem('berufe', JSON.stringify(data));\n                            for (let beruf in data) {\n                                //noinspection JSUnfilteredForInLoop,JSUnresolvedVariable\n                                $beruf.append('<option value=\"' + data[beruf].beruf_id + '\">' + data[beruf].beruf_name + '</option>');\n                            }\n                            $beruf.removeAttr('disabled');\n                        }\n                    }\n                );\n                break;\n            case this.types.classes:\n                // Load and add classes to the DOM\n                var jobId = $('#beruf').find('option:selected').attr('value');\n                if (typeof jobId === 'undefined') {\n                    $('#klasse').parent().parent().slideUp();\n                    return;\n                }\n                $.ajax(\n                    {\n                        \"url\":        \"http://home.gibm.ch/interfaces/133/klassen.php\",\n                        'data':       {\n                            \"beruf_id\": jobId\n                        },\n                        \"async\":      true,\n                        \"beforeSend\": function() {\n                            var $klasse = $('#klasse');\n                            $klasse.attr('disabled', 'disabled');\n                            $klasse.children().each(function() {\n                                if (typeof $(this).attr('value') !== 'undefined') {\n                                    $(this).remove();\n                                }\n                            });\n                        },\n                        \"success\":    function(data) {\n                            var $klasse = $('#klasse');\n                            localStorage.setItem('klassen', JSON.stringify(data));\n                            for (let clas in data) {\n                                //noinspection JSUnfilteredForInLoop,JSUnresolvedVariable\n                                $klasse.append('<option value=\"' + data[clas].klasse_id + '\" title=\"' + data[clas].klasse_longname + '\">' + data[clas].klasse_name + '</option>');\n                            }\n                            $klasse.removeAttr('disabled');\n                            //noinspection JSValidateTypes\n                            $klasse.parent().parent().slideDown();\n                        }\n                    }\n                );\n                break;\n            case this.types.schedules:\n                // Load and add schedules to the DOM\n                //noinspection JSJQueryEfficiency\n                var classId = $('#klasse').find('option:selected').attr('value');\n                if (typeof classId === 'undefined') {\n                    return;\n                }\n                $.ajax(\n                    {\n                        \"url\":     \"http://home.gibm.ch/interfaces/133/tafel.php\",\n                        'data':    {\n                            'klasse_id': classId,\n                            'woche':     data\n                        },\n                        'async':   true,\n                        \"success\": function(data) {\n                            var events = [];\n                            for (let event in data) {\n                                let obj = data[event];\n                                // Temporary create a object with simpler properties.\n                                event   = {\n                                    'date':    obj.tafel_datum,\n                                    'weekday': obj.tafel_wochentag,\n                                    'from':    obj.tafel_von,\n                                    'until':   obj.tafel_bis,\n                                    'teacher': obj.tafel_lehrer,\n                                    'subj':    obj.tafel_fach,\n                                    'subject': obj.tafel_longfach,\n                                    'room':    obj.tafel_raum,\n                                    'comment': (obj.tafel_kommentar ? \"<br><br>\" + obj.tafel_kommentar : \"\")\n\n                                };\n\n                                events.push(\n                                    {\n                                        'title':       event.subj + \"\\n\" + event.room,\n                                        'start':       event.date + 'T' + event.from,\n                                        'end':         event.date + 'T' + event.until,\n                                        'description': event.subject + \"<br>\" + event.teacher + \"<br>\" + event.room + event.comment,\n                                        'color':       '#FF5722'\n                                    }\n                                );\n                            }\n\n                            // This allows me to return a value outside of the $.ajax-scope.\n                            return callback(events);\n                        }\n                    }\n                );\n                break;\n            default:\n                // None of the constants where supplied\n                console.warn(\"Type: \" + type + \" is not in the type definition!\");\n                break;\n        }\n    },\n    /**\n     * Adds the EventListeners to the DOM.\n     */\n    addEventListeners: function() {\n        $('#beruf').on('change', function() {\n            var selected = $(this).find('option:selected');\n            localStorage.removeItem('klasse');\n            localStorage.removeItem('klassen');\n            if (typeof selected.attr('value') !== 'undefined') {\n                localStorage.setItem('beruf', selected.attr('value'));\n            } else {\n                localStorage.removeItem('beruf');\n            }\n            $('#calendar-container').removeClass('boot');\n            Scheduler.load(Scheduler.types.classes);\n        });\n        $('#klasse').on('change', function() {\n            var selected = $(this).find('option:selected');\n            if (typeof selected.attr('value') !== 'undefined') {\n                localStorage.setItem('klasse', selected.attr('value'));\n            } else {\n                localStorage.removeItem('klasse');\n                $('#calendar-container').removeClass('boot');\n            }\n            $('.panel-heading').trigger('click');\n            $('#calendar').fullCalendar('today');\n            setTimeout(function() {\n                $('#calendar-container').addClass('boot').addClass('booted');\n            }, 400);\n        });\n        $('.filters.panel-heading').on('click', function() {\n            var that = this;\n            var $sb  = $('.scheduler-body');\n            if ($sb.is(':visible')) {\n                $sb.slideUp(400, function() {\n                    $(that).addClass('closed');\n                });\n            } else {\n                $(this).removeClass('closed');\n                $sb.slideDown();\n            }\n        });\n    }\n};\n\n// Variable for requirejs\ndefine(Scheduler);\n"]}